<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>KnowMal</title>
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div class="container">
    <header>
      <img src="images/KnowMal_logo.png" alt="KnowMal Logo" class="logo-image">
      <div>
        <div class="title-row">
          <h1>KnowMal</h1>
          <div class="provider">제공: AI_Know</div>
        </div>
        <div class="sub">문서 실행 전 악성 행위 예측 서비스</div>
      </div>
    </header>

    <!-- 파일 선택/드롭존 -->
    <section class="card">
      <div id="drop" class="drop" tabindex="0" aria-label="파일 드래그 앤 드롭 영역">
        <div id="dropText" style="display: none;">파일을 이곳에 드롭하거나,<br> 아래 버튼으로 선택하세요.</div>
        
        <div id="fileInfo" class="file-info" style="display: none;">
          <div class="file-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M14 2V8H20" stroke="curentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M10 9H9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="file-details">
            <div class="file-name"></div>
            <div class="file-size"></div>
          </div>
        </div>
        
        <!-- 파일 입력을 드롭존 안으로 이동 -->
        <div class="file-input-container">
          <button id="fileSelectBtn" class="btn-file-select">
            <span class="btn-icon">📁</span>
            파일 선택
          </button>
          <input type="file" id="fileInput" style="display: none;" />
          <div id="fileStatus" class="file-status">드래그하거나 클릭하세요</div>
        </div>
      </div>

      <!-- 간결한 경고 박스 - 드롭존을 완전히 대체 -->
      <div id="overallConclusion" class="warning-box" style="display: none;">
        <div class="warning-icon">🚨</div>
        <div class="warning-text">
          <div class="warning-title">위험: 파일을 열지 마세요</div>
          <div class="warning-subtitle">악성코드가 탐지되었습니다</div>
        </div>
      </div>
      
      <!-- 접기/펼치기 가능한 상세 분석 결과 -->
      <div id="detailedResults" class="detailed-results" style="display: none;">
        <div class="details-header" onclick="toggleDetails()">
          <span class="details-title">▼ 상세 분석 결과</span>
          <span class="toggle-icon">▼</span>
        </div>
        <div class="details-content">
          <!-- 2단 레이아웃 컨테이너 -->
          <div class="result-container">
            <!-- AI 예측 결과 (왼쪽) -->
            <div class="ai-prediction-section">
              <h3 class="section-title">📊 AI 예측 결과</h3>
              
              <!-- AI 위험 요약 카드 -->
              <div class="ai-risk-card">
                <div class="ai-risk-title">AI가 탐지한 핵심 위협: <span class="risk-count">3건</span></div>
                <div class="threat-tags-container">
                  <span class="threat-tag" data-tooltip="공격자가 사용자의 시스템에 몰래 접근할 수 있도록 만들어진 통로입니다.">BACKDOOR</span>
                  <span class="threat-tag" data-tooltip="악성코드에 감염된 컴퓨터들이 네트워크로 연결되어 공격자의 명령을 받는 시스템입니다.">BOTNET</span>
                  <span class="threat-tag" data-tooltip="사용자의 개인정보나 중요한 데이터를 암호화하여 금전을 요구하는 악성코드입니다.">RANSOMWARE</span>
                </div>
              </div>
              
              <!-- 네트워크 통계 예제 -->
              <div class="network-stats">
                <h4 class="subsection-title">네트워크 통계 예제</h4>
                <div class="network-item">
                  <span class="network-label">external_session_count:</span>
                  <span class="network-value" id="netExternalSession">-</span>
                </div>
                <div class="network-item">
                  <span class="network-label">dns_domains_count:</span>
                  <span class="network-value" id="netDnsDomains">-</span>
                </div>
                <div class="network-item">
                  <span class="network-label">http_host_count:</span>
                  <span class="network-value" id="netHttpHost">-</span>
                </div>
              </div>
            </div>
            
            <!-- VirusTotal 결과 (오른쪽) -->
            <div class="virustotal-section">
              <h3 class="section-title">🔍 VirusTotal 바이러스 검사 결과</h3>
              
              <!-- 위험도 카드 -->
              <div class="vt-risk-card" id="vtRiskCard">
                <div class="risk-level" id="vtRiskLevel">매우 위험</div>
                <div class="risk-percentage" id="vtRiskPercentage">43.8%</div>
                <div class="risk-details" id="vtRiskDetails">32/73 탐지</div>
              </div>
              
              <!-- 검사 통계 -->
              <div class="vt-stats">
                <div class="stat-item">
                  <span class="stat-label">검사 엔진 수:</span>
                  <span class="stat-value" id="vtTotalEngines">73개</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">탐지 횟수:</span>
                  <span class="stat-value" id="vtDetections">32개</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">검사 날짜:</span>
                  <span class="stat-value" id="vtScanDate">2021-09-13</span>
                </div>
              </div>
              
              <!-- 과일 통칭 태그 -->
              <div class="vt-tags">
                <h4 class="subsection-title">파일 특징</h4>
                <div class="tag-container" id="vtTags">
                  <span class="tag">open-file</span>
                  <span class="tag">checks-cpu-name</span>
                  <span class="tag">detect-debug-environment</span>
                  <span class="tag">macros</span>
                  <span class="tag">long-sleeps</span>
                  <span class="tag">doc</span>
                  <span class="tag">calls-wmi</span>
                  <span class="tag">cve-2014-3931</span>
                  <span class="tag">exploit</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 가운데 정렬된 액션 버튼들 -->
      <div class="actions">
        <button id="btnUpload" class="btn-primary" disabled>서버로 전송</button>
        <button id="btnReport" class="btn-secondary" disabled>탐지 내역 확인</button>
      </div>

      <!-- 상태/진행 -->
      <div class="status-container">
        <span id="statusPill" class="pill">
          <span class="dot" style="background:#9ca3af"></span>대기
        </span>
        <div class="meter">
          <span id="prog" class="fill"></span>
        </div>
      </div>
    </section>

    <!-- 분석 결과 섹션 제거됨 - 내용이 종합 판정에 통합됨 -->
  </div>

  <script src="config.js"></script>
  <script src="popup.js"></script>
</body>
</html>
